% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/report_excel.R
\name{write_table_to_wb}
\alias{write_table_to_wb}
\title{Scrive e formatta una tabella in un workbook **openxlsx**}
\usage{
write_table_to_wb(
  wb,
  df,
  title,
  subtitle,
  source = NULL,
  note = NULL,
  sheet_name = "Foglio1",
  start_row = 4,
  header_df = NULL,
  apply_labels = TRUE
)
}
\arguments{
\item{wb}{\code{openxlsx::Workbook}. Oggetto workbook aperto o creato.}

\item{df}{\code{data.frame}. Dataset da esportare.}

\item{title}{\code{character(1)}. Titolo principale (riga 1).}

\item{subtitle}{\code{character(1)}. Sottotitolo (riga 2).}

\item{source}{\code{character(1)}. Testo “Fonte: …”.}

\item{note}{\code{character(1)}. Nota esplicativa.}

\item{sheet_name}{\code{character(1)}. Nome del foglio (default ``"Foglio1"``).
Se non esiste viene creato.}

\item{start_row}{\code{integer(1)}. Riga da cui far partire l’header
(default 4).}

\item{header_df}{\code{data.frame} opzionale con colonne \code{name}/\code{label}
per applicare etichette descrittive.}

\item{apply_labels}{\code{logical(1)}. Se \code{TRUE} (default) applica i
label presenti in \code{header_df}.}
}
\value{
Invisibilmente, lo stesso \code{wb} modificato.
}
\description{
Crea (o aggiorna) un foglio Excel con:
\itemize{
  \item Titolo e sottotitolo nelle prime due righe;
  \item Un doppio header (riga blu con descrizioni e riga grigia con nomi tecnici);
  \item Una terza riga “formule” con lettere \emph{A, B, C…} per
        le sole colonne numeric/Date/percentuale;
  \item La tabella dati, bordata, con formati:
        interi ``#,##0``, decimali ``#,##0.00``, percentuali ``0%``;
  \item Una riga “Totale” con somma automatica esclusa sulle percentuali;
  \item Fonte e nota finali, senza fusione celle;
  \item Larghezze calcolate sui dati (con minimi globali) e griglia disattivata.
}
}
\details{

}
\examples{
\dontrun{
library(openxlsx)
wb <- createWorkbook()

write_table_to_wb(
  wb        = wb,
  df        = iris,
  title     = "Analisi Iris",
  subtitle  = "Esempio di tabella formattata",
  source    = "Fonte: dataset iris",
  note      = "Nota: misure in centimetri.",
  sheet_name = "Iris",
  start_row  = 4
)

saveWorkbook(wb, "iris_formattata.xlsx", overwrite = TRUE)
}

}
\seealso{
\code{\link[openxlsx]{createWorkbook}}, \code{is_pct_col},
         \code{is_int_col}
}
\keyword{internal}
